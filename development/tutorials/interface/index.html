<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Interface · Typstry.jl</title><meta name="title" content="Interface · Typstry.jl"/><meta property="og:title" content="Interface · Typstry.jl"/><meta property="twitter:title" content="Interface · Typstry.jl"/><meta name="description" content="Documentation for Typstry.jl."/><meta property="og:description" content="Documentation for Typstry.jl."/><meta property="twitter:description" content="Documentation for Typstry.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Typstry.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Typstry.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Interface</a><ul class="internal"><li><a class="tocitem" href="#Setup"><span>Setup</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Guidelines"><span>Guidelines</span></a></li></ul></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/strings/">Strings</a></li><li><a class="tocitem" href="../../manual/commands/">Commands</a></li><li><a class="tocitem" href="../../manual/internals/">Internals</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Interface</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Interface</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jakobjpeters/Typstry.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jakobjpeters/Typstry.jl/blob/main/docs/src/tutorials/interface.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Interface"><a class="docs-heading-anchor" href="#Interface">Interface</a><a id="Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Interface" title="Permalink"></a></h1><p>This tutorial illustrates the Julia to Typst interface.</p><h2 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h2><pre><code class="language-julia-repl hljs">julia&gt; import Base: show

julia&gt; import Typstry: show_typst

julia&gt; using Base: Docs.Text

julia&gt; using Typstry</code></pre><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><p>Consider this new type.</p><pre><code class="language-julia-repl hljs">julia&gt; struct Greeting
           subject::String
       end</code></pre><p>To specify its Typst formatting, implement the <a href="../../manual/strings/#Typstry.show_typst"><code>show_typst</code></a> function. Remember to <a href="https://docs.julialang.org/en/v1/manual/performance-tips/#Annotate-values-taken-from-untyped-locations">Annotate values taken from untyped locations</a>.</p><pre><code class="language-julia-repl hljs">julia&gt; show_typst(io, g::Greeting) =
           print(io, &quot;Hi &quot;, g.subject, get(io, :excited, true)::Bool ? &quot;!&quot; : &quot;.&quot;);</code></pre><p>Now that the interface has been implemented for <code>Greeting</code>, it is fully supported by Typstry.jl.</p><pre><code class="language-julia-repl hljs">julia&gt; g = Greeting(&quot;everyone&quot;);

julia&gt; show_typst(IOContext(stdout, :excited =&gt; false), g)
Hi everyone.

julia&gt; show(stdout, &quot;text/typst&quot;, Typst(g))
Hi everyone!

julia&gt; TypstString(g; excited = false)
typst&quot;Hi everyone.&quot;

julia&gt; typst&quot;\(g)&quot;
typst&quot;Hi everyone!&quot;</code></pre><h2 id="Guidelines"><a class="docs-heading-anchor" href="#Guidelines">Guidelines</a><a id="Guidelines-1"></a><a class="docs-heading-anchor-permalink" href="#Guidelines" title="Permalink"></a></h2><p>While the interface itself only requires implementing a single method, it may be more challenging to determine how a Julia value should be represented in a Typst source file and its corresponding rendered document. Julia and Typst are distinct languages and differ in both syntax and semantics, so there may be multiple meaningful formats to choose from.</p><h3 id="Make-the-obvious-choice,-if-available"><a class="docs-heading-anchor" href="#Make-the-obvious-choice,-if-available">Make the obvious choice, if available</a><a id="Make-the-obvious-choice,-if-available-1"></a><a class="docs-heading-anchor-permalink" href="#Make-the-obvious-choice,-if-available" title="Permalink"></a></h3><ul><li>There is a clear correspondence between these Julia and Typst values</li></ul><pre><code class="language-julia-repl hljs">julia&gt; println(TypstString(1))
1

julia&gt; println(TypstString(nothing))
#none

julia&gt; println(TypstString(r&quot;[a-z]&quot;))
#regex(&quot;[a-z]&quot;)</code></pre><h3 id="Choose-the-most-meaningful-and-semantically-rich-representation"><a class="docs-heading-anchor" href="#Choose-the-most-meaningful-and-semantically-rich-representation">Choose the most meaningful and semantically rich representation</a><a id="Choose-the-most-meaningful-and-semantically-rich-representation-1"></a><a class="docs-heading-anchor-permalink" href="#Choose-the-most-meaningful-and-semantically-rich-representation" title="Permalink"></a></h3><ul><li>This may vary across <code>Mode</code>s and domains</li><li>Both Julia and Typst support Unicode characters, except in Typst&#39;s <code>code</code> mode</li></ul><pre><code class="language-julia-repl hljs">julia&gt; println(TypstString(π; mode = code))
3.141592653589793

julia&gt; println(TypstString(π; mode = math))
π</code></pre><h3 id="Consider-both-the-Typst-source-text-and-rendered-document-formatting"><a class="docs-heading-anchor" href="#Consider-both-the-Typst-source-text-and-rendered-document-formatting">Consider both the Typst source text and rendered document formatting</a><a id="Consider-both-the-Typst-source-text-and-rendered-document-formatting-1"></a><a class="docs-heading-anchor-permalink" href="#Consider-both-the-Typst-source-text-and-rendered-document-formatting" title="Permalink"></a></h3><ul><li>A <code>TypstString</code> represents Typst source text, and is printed directly</li><li>A <code>String</code> is meaningful in different ways for each Typst mode</li><li>A <code>Text</code> is documented to render as plain text, and therefore corresponds to text in the rendered Typst document</li></ul><pre><code class="language-julia-repl hljs">julia&gt; println(TypstString(typst&quot;[\&quot;a\&quot;]&quot;))
[&quot;a&quot;]

julia&gt; println(TypstString(&quot;[\&quot;a\&quot;]&quot;))
&quot;[\&quot;a\&quot;]&quot;

julia&gt; println(TypstString(text&quot;[\&quot;a\&quot;]&quot;))
#&quot;[\&quot;a\&quot;]&quot;</code></pre><h3 id="Try-to-ensure-that-the-formatting-is-valid-Typst-source-text"><a class="docs-heading-anchor" href="#Try-to-ensure-that-the-formatting-is-valid-Typst-source-text">Try to ensure that the formatting is valid Typst source text</a><a id="Try-to-ensure-that-the-formatting-is-valid-Typst-source-text-1"></a><a class="docs-heading-anchor-permalink" href="#Try-to-ensure-that-the-formatting-is-valid-Typst-source-text" title="Permalink"></a></h3><ul><li>A <code>TypstString</code> represents Typst source text, so it may be invalid</li><li>A <code>UnitRange{Int}</code> is formatted differently for each <code>Mode</code>, but is always valid</li></ul><pre><code class="language-julia-repl hljs">julia&gt; println(TypstString(1:4; mode = code))
range(1, 5)

julia&gt; println(TypstString(1:4; mode = math))
vec(
    1, 2, 3, 4
)

julia&gt; println(TypstString(1:4; mode = markup))
$vec(
    1, 2, 3, 4
)$</code></pre><h3 id="Consider-edge-cases"><a class="docs-heading-anchor" href="#Consider-edge-cases">Consider edge cases</a><a id="Consider-edge-cases-1"></a><a class="docs-heading-anchor-permalink" href="#Consider-edge-cases" title="Permalink"></a></h3><ul><li><code>#1 / 2</code> is valid Typst source text, but is parsed as <code>(#1) / 2</code></li><li><code>1 / 2</code> may be ambiguous in a mathematical expression</li><li><code>$1 / 2$</code> is not ambiguous</li></ul><pre><code class="language-julia-repl hljs">julia&gt; println(TypstString(1 // 2; mode = code))
(1 / 2)

julia&gt; println(TypstString(1 // 2; mode = math))
(1 / 2)

julia&gt; println(TypstString(1 // 2; mode = markup))
$1 / 2$</code></pre><h3 id="Remember-to-update-the-context"><a class="docs-heading-anchor" href="#Remember-to-update-the-context">Remember to update the context</a><a id="Remember-to-update-the-context-1"></a><a class="docs-heading-anchor-permalink" href="#Remember-to-update-the-context" title="Permalink"></a></h3><ul><li>This nested <code>AbstractVector</code> changes its <code>Mode</code> to <code>math</code> and increments its <code>depth</code></li></ul><pre><code class="language-julia-repl hljs">julia&gt; println(TypstString([true, 1, Any[1.2, 1 // 2]]))
$vec(
    &quot;true&quot;, 1, vec(
        1.2, 1 / 2
    )
)$</code></pre><h3 id="Check-parametric-and-abstract-types"><a class="docs-heading-anchor" href="#Check-parametric-and-abstract-types">Check parametric and abstract types</a><a id="Check-parametric-and-abstract-types-1"></a><a class="docs-heading-anchor-permalink" href="#Check-parametric-and-abstract-types" title="Permalink"></a></h3><ul><li>Similar Julia types may not be representable in the same Typst format</li></ul><pre><code class="language-julia-repl hljs">julia&gt; println(TypstString(1:2:6; mode = code))
range(1, 6, step: 2)

julia&gt; println(TypstString(1:2.0:6; mode = code))
(1.0, 3.0, 5.0)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../getting_started/">« Getting Started</a><a class="docs-footer-nextpage" href="../../manual/strings/">Strings »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Sunday 26 May 2024 14:03">Sunday 26 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
